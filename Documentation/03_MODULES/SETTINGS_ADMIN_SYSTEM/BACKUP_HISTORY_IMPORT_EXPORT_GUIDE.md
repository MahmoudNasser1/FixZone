# ğŸ“š Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„: Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØŒ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯/Ø§Ù„ØªØµØ¯ÙŠØ±

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ (Backup)](#1-ØªØ¨ÙˆÙŠØ¨-Ø§Ù„Ù†Ø³Ø®-Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ-backup)
2. [Ø³ÙŠÙƒØ´Ù† Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ§Ù„ØªØµØ¯ÙŠØ± (Import/Export)](#2-Ø³ÙŠÙƒØ´Ù†-Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯-ÙˆØ§Ù„ØªØµØ¯ÙŠØ±-importexport)
3. [ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (History)](#3-ØªØ¨ÙˆÙŠØ¨-Ø§Ù„ØªØ§Ø±ÙŠØ®-history)
4. [Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©](#4-Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª-Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©)

---

## 1. ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ (Backup)

### ğŸ¯ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡ Ù‡Ø°Ø§ Ø§Ù„ØªØ¨ÙˆÙŠØ¨:

ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙŠØ³Ù…Ø­ Ù„Ùƒ Ø¨Ø­ÙØ¸ **Ø¬Ù…ÙŠØ¹ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…** ÙÙŠ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¹Ø§Ø¯ØªÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹.

### âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:

#### 1.1 Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© (Create Backup)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ­ÙØ¸Ù‡Ø§ ÙÙŠ Ø¬Ø¯ÙˆÙ„ `SettingBackup` Ù…Ø¹:
  - Ø§Ø³Ù… Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
  - ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (JSON)
  - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ù†Ø´Ø£Ù‡Ø§
  - Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsBackupService.js
async createBackup(name, description, userId) {
  // 1. Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  const allSettings = await settingsRepository.findAll({}, {});
  
  // 2. Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
  const backup = {
    name: name || `Backup_${new Date().toISOString()}`,
    description: description || null,
    settings: allSettings.map(setting => ({
      key: setting.key,
      value: setting.value,
      type: setting.type,
      category: setting.category,
      // ... Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    })),
    createdBy: userId
  };
  
  // 3. Ø­ÙØ¸ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const savedBackup = await settingsBackupRepository.create(backup);
  return savedBackup;
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø¶ØºØ· "Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©"
2. Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø³Ø®Ø© (Ù…Ø«Ø§Ù„: "Backup Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«")
3. Ø£Ø¯Ø®Ù„ ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
4. Ø§Ø¶ØºØ· "Ø¥Ù†Ø´Ø§Ø¡"

---

#### 1.2 Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© (List Backups)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
- ÙŠØ¸Ù‡Ø± Ù„ÙƒÙ„ Ù†Ø³Ø®Ø©:
  - Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙˆØµÙ
  - Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
  - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ù†Ø´Ø£Ù‡Ø§
  - Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/repositories/settingsBackupRepository.js
async findAll(pagination = {}) {
  const sql = `
    SELECT sb.*, u.name as createdByName, u.email as createdByEmail
    FROM SettingBackup sb
    LEFT JOIN User u ON sb.createdBy = u.id
    ORDER BY sb.createdAt DESC
  `;
  // ... pagination
}
```

---

#### 1.3 Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© (Restore Backup)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¬Ù„Ø¨ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ¹ÙŠØ¯ ÙƒÙ„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ù‚ÙŠÙ…ØªÙ‡ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
- Ù„Ø¯ÙŠÙ‡ Ø®ÙŠØ§Ø±Ø§Øª:
  - **overwriteExisting**: Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
  - **skipSystemSettings**: ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsBackupService.js
async restoreBackup(backupId, userId, options = {}) {
  const { overwriteExisting = true, skipSystemSettings = true } = options;
  
  // 1. Ø¬Ù„Ø¨ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
  const backup = await settingsBackupRepository.findById(backupId);
  
  // 2. Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„ Ø¥Ø¹Ø¯Ø§Ø¯
  for (const setting of backup.settings) {
    // ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø¥Ø°Ø§ Ø·ÙÙ„Ø¨
    if (skipSystemSettings && setting.isSystem) {
      skipped.push({ key: setting.key, reason: 'System setting' });
      continue;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
    const existing = await settingsRepository.findByKey(setting.key);
    if (existing) {
      if (!overwriteExisting) {
        skipped.push({ key: setting.key, reason: 'Setting already exists' });
        continue;
      }
      await settingsService.updateSetting(setting.key, {...}, userId);
    } else {
      await settingsService.createSetting({...}, userId);
    }
  }
  
  return {
    restored: restored.length,
    skipped: skipped.length,
    errors: errors.length
  };
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø®ØªØ± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
2. Ø§Ø¶ØºØ· "Ø§Ø³ØªØ¹Ø§Ø¯Ø©"
3. Ø§Ø®ØªØ± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª:
   - âœ… Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
   - âœ… ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
4. Ø§Ø¶ØºØ· "Ø§Ø³ØªØ¹Ø§Ø¯Ø©"

---

#### 1.4 Ø­Ø°Ù Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© (Delete Backup)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- **ØªØ­Ø°ÙŠØ±:** Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¹Ø§Ø¯ØªÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù

---

### ğŸ”§ Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ:

#### 1. Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (Auto Backup)
```javascript
// Ù…Ø«Ø§Ù„: Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙŠÙˆÙ…ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
async scheduleAutoBackup() {
  // ÙƒÙ„ ÙŠÙˆÙ… Ø§Ù„Ø³Ø§Ø¹Ø© 2 ØµØ¨Ø§Ø­Ø§Ù‹
  cron.schedule('0 2 * * *', async () => {
    await settingsBackupService.createBackup(
      `Auto Backup ${new Date().toLocaleDateString()}`,
      'Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙŠÙˆÙ…ÙŠØ©',
      systemUserId
    );
  });
}
```

#### 2. Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
```javascript
// Ù‚Ø¨Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
async updateSetting(key, value, userId, reason) {
  // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«
  await this.createBackup(
    `Pre-Update Backup: ${key}`,
    `Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù‚Ø¨Ù„ ØªØ­Ø¯ÙŠØ« ${key}`,
    userId
  );
  
  // Ø«Ù… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  // ...
}
```

#### 3. Ø¶ØºØ· Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
```javascript
// Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† 30 ÙŠÙˆÙ…
async cleanupOldBackups() {
  const thirtyDaysAgo = new Date();
  thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
  
  await db.execute(
    'DELETE FROM SettingBackup WHERE createdAt < ?',
    [thirtyDaysAgo]
  );
}
```

#### 4. Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
```javascript
// Ù…Ù‚Ø§Ø±Ù†Ø© Ù†Ø³Ø®ØªÙŠÙ† Ø§Ø­ØªÙŠØ§Ø·ÙŠØªÙŠÙ† Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª
async compareBackups(backupId1, backupId2) {
  const backup1 = await this.getBackup(backupId1);
  const backup2 = await this.getBackup(backupId2);
  
  const differences = [];
  backup1.settings.forEach(setting1 => {
    const setting2 = backup2.settings.find(s => s.key === setting1.key);
    if (!setting2 || setting1.value !== setting2.value) {
      differences.push({
        key: setting1.key,
        oldValue: setting1.value,
        newValue: setting2?.value
      });
    }
  });
  
  return differences;
}
```

#### 5. ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙƒÙ…Ù„ÙØ§Øª
```javascript
// ØªØµØ¯ÙŠØ± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙƒÙ…Ù„Ù JSON
async exportBackupToFile(backupId) {
  const backup = await this.getBackup(backupId);
  const filename = `backup_${backup.name}_${Date.now()}.json`;
  
  await fs.writeFile(
    path.join('backups', filename),
    JSON.stringify(backup, null, 2)
  );
  
  return filename;
}
```

---

## 2. Ø³ÙŠÙƒØ´Ù† Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ§Ù„ØªØµØ¯ÙŠØ± (Import/Export)

### ğŸ¯ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡ Ù‡Ø°Ø§ Ø§Ù„Ø³ÙŠÙƒØ´Ù†:

ÙŠØ³Ù…Ø­ Ù„Ùƒ Ø¨ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù JSON ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯Ù‡Ø§ Ù…Ù† Ù…Ù„Ù JSON.

### âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:

#### 2.1 ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Export Settings)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Ø£Ùˆ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„ØªØ±)
- ÙŠØ­ÙˆÙ„Ù‡Ø§ Ø¥Ù„Ù‰ JSON
- ÙŠØ³Ù…Ø­ Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsImportExportService.js
async exportSettings(format = 'json', filters = {}) {
  // 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙÙ„ØªØ±
  const settings = await settingsRepository.findAll(filters, {});
  
  // 2. ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
  const exportData = {
    version: '1.0',
    exportedAt: new Date().toISOString(),
    exportedBy: 'system',
    settings: settings.map(setting => ({
      key: setting.key,
      value: setting.value,
      type: setting.type,
      category: setting.category,
      // ... Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    }))
  };
  
  // 3. Ø¥Ø±Ø¬Ø§Ø¹ JSON
  return {
    format: 'json',
    data: JSON.stringify(exportData, null, 2),
    filename: `settings_export_${new Date().toISOString()}.json`
  };
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø¶ØºØ· "ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"
2. Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù JSON
3. Ø§Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†

**Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ÙØµØ¯Ù‘Ø±:**
```json
{
  "version": "1.0",
  "exportedAt": "2025-01-28T10:30:00.000Z",
  "exportedBy": "system",
  "settings": [
    {
      "key": "company.name",
      "value": "FixZone",
      "type": "string",
      "category": "company",
      "description": "Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©"
    },
    {
      "key": "currency.code",
      "value": "EGP",
      "type": "string",
      "category": "currency"
    }
  ]
}
```

---

#### 2.2 Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Import Settings)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠÙ‚Ø±Ø£ Ù…Ù„Ù JSON
- ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- ÙŠØ³ØªÙˆØ±Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø¹ Ø®ÙŠØ§Ø±Ø§Øª:
  - **overwriteExisting**: Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
  - **skipSystemSettings**: ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsImportExportService.js
async importSettings(filePath, userId, options = {}) {
  const { overwriteExisting = false, skipSystemSettings = true } = options;
  
  // 1. Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù
  const fileContent = await fs.readFile(filePath, 'utf8');
  const importData = JSON.parse(fileContent);
  
  // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  if (!importData.settings || !Array.isArray(importData.settings)) {
    throw new Error('Invalid import file format');
  }
  
  // 3. Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙ„ Ø¥Ø¹Ø¯Ø§Ø¯
  for (const setting of importData.settings) {
    // ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø¥Ø°Ø§ Ø·ÙÙ„Ø¨
    if (skipSystemSettings && setting.isSystem) {
      skipped.push({ key: setting.key, reason: 'System setting' });
      continue;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
    const existing = await settingsRepository.findByKey(setting.key);
    
    if (existing) {
      if (!overwriteExisting) {
        skipped.push({ key: setting.key, reason: 'Setting already exists' });
        continue;
      }
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
      await settingsService.updateSetting(setting.key, {...}, userId);
    } else {
      // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¬Ø¯ÙŠØ¯
      await settingsService.createSetting({...}, userId);
    }
  }
  
  return {
    imported: imported.length,
    skipped: skipped.length,
    errors: errors.length
  };
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø¶ØºØ· "Ø§Ø®ØªØ± Ù…Ù„Ù JSON"
2. Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù
3. Ø³ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
4. Ø§Ø®ØªØ± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª:
   - âœ… Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
   - âœ… ØªØ®Ø·ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
5. Ø§Ø¶ØºØ· "Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"

---

#### 2.3 Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ù„Ø¨ (Get Template)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¹Ø·ÙŠ Ù…Ù„Ù JSON Ù‚Ø§Ù„Ø¨ ÙØ§Ø±Øº
- ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙƒÙ…Ø±Ø¬Ø¹ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ø³ØªÙŠØ±Ø§Ø¯

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
async getExportTemplate() {
  return {
    version: '1.0',
    exportedAt: new Date().toISOString(),
    exportedBy: 'template',
    settings: [
      {
        key: 'example.setting.key',
        value: 'example value',
        type: 'string',
        category: 'general',
        description: 'Example setting description'
      }
    ]
  };
}
```

---

#### 2.4 Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù (Validate File)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ù…Ù„Ù JSON Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
- ÙŠØªØ­Ù‚Ù‚ Ù…Ù†:
  - ØµØ­Ø© Ø§Ù„Ø¨Ù†ÙŠØ© (JSON valid)
  - ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
  - ØµØ­Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
async validateImportFile(filePath) {
  try {
    const result = await this.importSettings(filePath, null, {
      validateOnly: true,  // ÙÙ‚Ø· Ø§Ù„ØªØ­Ù‚Ù‚ØŒ Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªÙŠØ±Ø§Ø¯
      overwriteExisting: false,
      skipSystemSettings: true
    });
    
    return {
      valid: result.errors.length === 0,
      ...result
    };
  } catch (error) {
    return {
      valid: false,
      error: error.message
    };
  }
}
```

---

### ğŸ”§ Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯/Ø§Ù„ØªØµØ¯ÙŠØ±:

#### 1. ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ø²Ø¦ÙŠ (Selective Export/Import)
```javascript
// ØªØµØ¯ÙŠØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ¦Ø© Ù…Ø¹ÙŠÙ†Ø© ÙÙ‚Ø·
async exportSettingsByCategory(category) {
  return await this.exportSettings('json', { category });
}

// Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ¦Ø© Ù…Ø¹ÙŠÙ†Ø© ÙÙ‚Ø·
async importSettingsByCategory(filePath, category) {
  const importData = JSON.parse(await fs.readFile(filePath, 'utf8'));
  const filteredSettings = importData.settings.filter(s => s.category === category);
  // ... Ø§Ø³ØªÙŠØ±Ø§Ø¯
}
```

#### 2. ØªØµØ¯ÙŠØ± Ø¨ØµÙŠØº Ù…ØªØ¹Ø¯Ø¯Ø©
```javascript
// ØªØµØ¯ÙŠØ± Ø¨ØµÙŠØºØ© CSV
async exportToCSV() {
  const settings = await settingsRepository.findAll({}, {});
  const csv = settings.map(s => `${s.key},${s.value},${s.category}`).join('\n');
  return { format: 'csv', data: csv, filename: 'settings.csv' };
}

// ØªØµØ¯ÙŠØ± Ø¨ØµÙŠØºØ© XML
async exportToXML() {
  // ...
}
```

#### 3. Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
```javascript
// Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† URL
async importFromURL(url) {
  const response = await fetch(url);
  const fileContent = await response.text();
  const tempPath = path.join('uploads/temp', `import_${Date.now()}.json`);
  await fs.writeFile(tempPath, fileContent);
  return await this.importSettings(tempPath, userId);
}

// Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø®Ø±Ù‰
async importFromDatabase(connectionString) {
  // ...
}
```

#### 4. Ù…Ù‚Ø§Ø±Ù†Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
```javascript
// Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ Ø§Ù„Ù…Ù„Ù Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
async compareWithFile(filePath) {
  const importData = JSON.parse(await fs.readFile(filePath, 'utf8'));
  const currentSettings = await settingsRepository.findAll({}, {});
  
  const differences = [];
  importData.settings.forEach(imported => {
    const current = currentSettings.find(s => s.key === imported.key);
    if (!current || current.value !== imported.value) {
      differences.push({
        key: imported.key,
        currentValue: current?.value,
        importedValue: imported.value,
        action: current ? 'update' : 'create'
      });
    }
  });
  
  return differences;
}
```

#### 5. Ø§Ø³ØªÙŠØ±Ø§Ø¯ ØªØ¯Ø±ÙŠØ¬ÙŠ (Incremental Import)
```javascript
// Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙÙ‚Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªØºÙŠØ±Øª
async incrementalImport(filePath) {
  const importData = JSON.parse(await fs.readFile(filePath, 'utf8'));
  const currentSettings = await settingsRepository.findAll({}, {});
  
  const toImport = importData.settings.filter(imported => {
    const current = currentSettings.find(s => s.key === imported.key);
    return !current || current.value !== imported.value;
  });
  
  // Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙÙ‚Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØºÙŠØ±Ø©
  // ...
}
```

---

## 3. ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (History)

### ğŸ¯ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡ Ù‡Ø°Ø§ Ø§Ù„ØªØ¨ÙˆÙŠØ¨:

ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙŠØ³Ø¬Ù„ **Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª** Ø§Ù„ØªÙŠ ØªØ­Ø¯Ø« Ø¹Ù„Ù‰ ÙƒÙ„ Ø¥Ø¹Ø¯Ø§Ø¯ØŒ ÙˆÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ±Ø§Ø¬Ø¹ (Rollback) Ø¥Ù„Ù‰ Ø£ÙŠ Ù†Ø³Ø®Ø© Ø³Ø§Ø¨Ù‚Ø©.

### âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:

#### 3.1 ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® (History Logging)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ« Ø£ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ØŒ ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„:
  - Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
  - Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ ØºÙŠÙ‘Ø±Ù‡Ø§
  - Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
  - Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ± (Ø¥Ù† ÙˆØ¬Ø¯)
  - IP Address
  - User Agent

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsService.js
async updateSetting(key, data, userId, reason = null) {
  // 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ
  const existing = await settingsRepository.findByKey(key);
  const oldValue = existing ? existing.value : null;
  
  // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  const updated = await settingsRepository.update(key, data);
  
  // 3. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®
  await settingsHistoryRepository.create({
    settingId: updated.id,
    settingKey: key,
    oldValue: oldValue,
    newValue: updated.value,
    changedBy: userId,
    changeReason: reason,
    ipAddress: req?.ip || null,
    userAgent: req?.headers['user-agent'] || null
  });
  
  return updated;
}
```

**Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®:**
```json
{
  "id": 1,
  "settingKey": "company.name",
  "oldValue": "FixZone Old",
  "newValue": "FixZone New",
  "changedBy": 5,
  "changedByName": "Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ",
  "changeReason": "ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©",
  "createdAt": "2025-01-28T10:30:00.000Z",
  "ipAddress": "192.168.1.100",
  "userAgent": "Mozilla/5.0..."
}
```

---

#### 3.2 Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® (View History)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹ÙŠÙ†
- Ù…Ø±ØªØ¨Ø© Ù…Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø¯Ù…
- ÙŠØ¸Ù‡Ø±:
  - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ ØºÙŠÙ‘Ø±Ù‡Ø§
  - Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
  - Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  - Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/repositories/settingsHistoryRepository.js
async findBySettingKey(key, pagination = {}) {
  const sql = `
    SELECT sh.*, u.name as changedByName, u.email as changedByEmail
    FROM SettingHistory sh
    LEFT JOIN User u ON sh.changedBy = u.id
    WHERE sh.settingKey = ?
    ORDER BY sh.createdAt DESC
  `;
  // ... pagination
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø®ØªØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
2. Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
3. ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ©:
   - Ù…Ù† ØºÙŠÙ‘Ø±Ù‡Ø§
   - Ù…ØªÙ‰
   - Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯Ø©
   - Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±

---

#### 3.3 Ø§Ù„ØªØ±Ø§Ø¬Ø¹ (Rollback)

**Ù…Ø§ ÙŠØ­Ø¯Ø«:**
- ÙŠØ¹ÙŠØ¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø³Ø§Ø¨Ù‚Ø©
- ÙŠØ³Ø¬Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø£ÙŠØ¶Ø§Ù‹

**Ø§Ù„ÙƒÙˆØ¯:**
```javascript
// backend/services/settings/settingsService.js
async rollbackSetting(key, historyId, userId) {
  // 1. Ø¬Ù„Ø¨ Ø³Ø¬Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®
  const historyEntry = await settingsHistoryRepository.findById(historyId);
  
  if (!historyEntry || historyEntry.settingKey !== key) {
    throw new Error('History entry not found');
  }
  
  // 2. Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
  const current = await settingsRepository.findByKey(key);
  const oldValue = current ? current.value : null;
  
  await settingsRepository.update(key, {
    value: historyEntry.oldValue
  });
  
  // 3. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®
  await settingsHistoryRepository.create({
    settingId: current.id,
    settingKey: key,
    oldValue: oldValue,
    newValue: historyEntry.oldValue,
    changedBy: userId,
    changeReason: `Rollback to history entry #${historyId}`
  });
  
  return { success: true };
}
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ø®ØªØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Ù‹
2. Ø´Ø§Ù‡Ø¯ Ø§Ù„ØªØ§Ø±ÙŠØ®
3. Ø§Ø¶ØºØ· "ØªØ±Ø§Ø¬Ø¹" Ø¹Ù„Ù‰ Ø£ÙŠ ØªØºÙŠÙŠØ±
4. Ø³ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©

---

### ğŸ”§ Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù„ØªØ§Ø±ÙŠØ®:

#### 1. ÙÙ„ØªØ±Ø© Ø§Ù„ØªØ§Ø±ÙŠØ®
```javascript
// ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
async getHistoryByUser(userId) {
  return await settingsHistoryRepository.findAll({ changedBy: userId });
}

// ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
async getHistoryByDateRange(startDate, endDate) {
  return await settingsHistoryRepository.findAll({
    startDate: startDate,
    endDate: endDate
  });
}

// ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
async getHistoryByCategory(category) {
  const settings = await settingsRepository.findAll({ category }, {});
  const keys = settings.map(s => s.key);
  return await settingsHistoryRepository.findAll({
    settingKey: { $in: keys }
  });
}
```

#### 2. Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®
```javascript
// Ø£ÙƒØ«Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªØºÙŠÙŠØ±Ø§Ù‹
async getMostChangedSettings(limit = 10) {
  const sql = `
    SELECT settingKey, COUNT(*) as changeCount
    FROM SettingHistory
    GROUP BY settingKey
    ORDER BY changeCount DESC
    LIMIT ?
  `;
  // ...
}

// Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØªØºÙŠÙŠØ±Ø§Ù‹
async getMostActiveUsers(limit = 10) {
  const sql = `
    SELECT changedBy, COUNT(*) as changeCount
    FROM SettingHistory
    GROUP BY changedBy
    ORDER BY changeCount DESC
    LIMIT ?
  `;
  // ...
}
```

#### 3. Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª
```javascript
// Ù…Ù‚Ø§Ø±Ù†Ø© Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠÙ† ØªØ§Ø±ÙŠØ®ÙŠÙ†
async compareSettingVersions(key, historyId1, historyId2) {
  const history1 = await settingsHistoryRepository.findById(historyId1);
  const history2 = await settingsHistoryRepository.findById(historyId2);
  
  return {
    key: key,
    version1: {
      value: history1.newValue,
      date: history1.createdAt,
      user: history1.changedByName
    },
    version2: {
      value: history2.newValue,
      date: history2.createdAt,
      user: history2.changedByName
    },
    difference: history1.newValue !== history2.newValue
  };
}
```

#### 4. ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ§Ø±ÙŠØ®
```javascript
// ØªØµØ¯ÙŠØ± ØªØ§Ø±ÙŠØ® Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹ÙŠÙ†
async exportHistory(key, format = 'json') {
  const history = await settingsHistoryRepository.findBySettingKey(key);
  
  if (format === 'json') {
    return JSON.stringify(history, null, 2);
  } else if (format === 'csv') {
    const csv = history.map(h => 
      `${h.createdAt},${h.changedByName},${h.oldValue},${h.newValue}`
    ).join('\n');
    return csv;
  }
}
```

#### 5. ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‚Ø¯ÙŠÙ…
```javascript
// Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† 90 ÙŠÙˆÙ…
async cleanupOldHistory() {
  const ninetyDaysAgo = new Date();
  ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90);
  
  await db.execute(
    'DELETE FROM SettingHistory WHERE createdAt < ?',
    [ninetyDaysAgo]
  );
}
```

---

## 4. Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©

### ğŸš€ Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±:

#### Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù„ÙŠØ© (High Priority):
1. âœ… **Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙŠÙˆÙ…ÙŠØ©**
2. âœ… **ÙÙ„ØªØ±Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…/Ø§Ù„ØªØ§Ø±ÙŠØ®**
3. âœ… **Ù…Ù‚Ø§Ø±Ù†Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯**

#### Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© (Medium Priority):
4. âœ… **ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ø²Ø¦ÙŠ (Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©)**
5. âœ… **Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®**
6. âœ… **ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ§Ø±ÙŠØ®**

#### Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø© (Low Priority):
7. âœ… **Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©**
8. âœ… **ØªØµØ¯ÙŠØ± Ø¨ØµÙŠØº Ù…ØªØ¹Ø¯Ø¯Ø© (CSV, XML)**
9. âœ… **Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† URL**

---

## ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù…ÙŠØ²Ø§Øª

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ø­Ø§Ù„Ø© | Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© |
|--------|--------|---------------------|
| **Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ** | âœ… Ø¬Ø§Ù‡Ø² | Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠØ©ØŒ Ù…Ù‚Ø§Ø±Ù†Ø©ØŒ ØªØµØ¯ÙŠØ± |
| **Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯/Ø§Ù„ØªØµØ¯ÙŠØ±** | âœ… Ø¬Ø§Ù‡Ø² | Ø¬Ø²Ø¦ÙŠØŒ ØµÙŠØº Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ Ù…Ù‚Ø§Ø±Ù†Ø© |
| **Ø§Ù„ØªØ§Ø±ÙŠØ®** | âœ… Ø¬Ø§Ù‡Ø² | ÙÙ„ØªØ±Ø©ØŒ Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªØŒ ØªØµØ¯ÙŠØ± |

---

**ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨ÙˆØ§Ø³Ø·Ø©:** AI Assistant  
**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** 2025-01-28

