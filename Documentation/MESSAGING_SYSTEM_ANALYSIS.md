# ุชุญููู ูุธุงู ุงููุฑุงุณูุฉ - ุงููุดุงูู ูุงูุชุทููุฑุงุช

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุณุชูุฏ ูุญุชูู ุนูู ุชุญููู ุดุงูู ููุธุงู ุงููุฑุงุณูุฉ ุงูุญุงูู ูู FixZoneุ ุงููุดุงูู ุงูููุฌูุฏุฉุ ูุงูุชุทููุฑุงุช ุงูููุชุฑุญุฉ.

---

## ๐ ุงููุถุน ุงูุญุงูู

### 1. ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ (`MessagingSettingsPage.js`)

#### โ ูุง ูุนูู ุญุงููุงู:
- ุฅุนุฏุงุฏุงุช WhatsApp (Web + API)
- ุฅุนุฏุงุฏุงุช Email (SMTP)
- ููุงูุจ ุฑุณุงุฆู ููููุงุชูุฑ
- ููุงูุจ ุฑุณุงุฆู ูุทูุจุงุช ุงูุฅุตูุงุญ
- ุชุฌุฑุจุฉ ุงูุฅุฑุณุงู (Test buttons)

#### โ ุงููุดุงูู ุงูููุฌูุฏุฉ:

1. **ุนุฏู ูุฌูุฏ ุฎุฏูุฉ ููุญุฏุฉ ููุฅุฑุณุงู**
   - ูู ุตูุญุฉ ุชุนูุฏ ูุชุงุจุฉ ููุฏ ุงูุฅุฑุณุงู
   - ูุง ููุฌุฏ ููุงู ูุฑูุฒู ูุฅุฏุงุฑุฉ ุงูุฅุฑุณุงู
   - ุตุนูุจุฉ ุงูุตูุงูุฉ ูุงูุชุญุฏูุซ

2. **ุนุฏู ุงุณุชุฎุฏุงู Email ูุนููุงู**
   - ุงูุฅุนุฏุงุฏุงุช ููุฌูุฏุฉ ููู ูุง ูุชู ุงุณุชุฎุฏุงููุง ูู ุฃู ููุงู
   - ูุง ููุฌุฏ ููุฏ ูุฅุฑุณุงู Email ููุนููุงุก

3. **ุนุฏู ูุฌูุฏ ุณุฌู ููุฅุฑุณุงู**
   - ูุง ูุชู ุชุณุฌูู ูุญุงููุงุช ุงูุฅุฑุณุงู
   - ูุง ูููู ุชุชุจุน ูุง ุชู ุฅุฑุณุงูู ููุนููุงุก
   - ูุง ููุฌุฏ ุชุงุฑูุฎ ูููุฑุงุณูุงุช

4. **ุนุฏู ูุฌูุฏ ูุนุงูุฌุฉ ููุฃุฎุทุงุก ุจุดูู ููุญุฏ**
   - ูู ุตูุญุฉ ุชุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุจุดูู ูุฎุชูู
   - ูุง ููุฌุฏ retry mechanism
   - ูุง ููุฌุฏ fallback strategy ูุงุถุญ

5. **ุนุฏู ูุฌูุฏ ููุงูุจ ูุฌููุน ุงูุญุงูุงุช**
   - ููุท ููุงุชูุฑ ูุทูุจุงุช ุฅุตูุงุญ
   - ูุง ุชูุฌุฏ ููุงูุจ ููุนุฑูุถ ุงูุณุนุฑูุฉ
   - ูุง ุชูุฌุฏ ููุงูุจ ูุชุฐููุฑุงุช ุงูุฏูุน
   - ูุง ุชูุฌุฏ ููุงูุจ ูุญุงูุงุช ุฃุฎุฑู

---

### 2. ุฅุฑุณุงู ุงูููุงุชูุฑ (`InvoiceDetailsPage.js`)

#### โ ูุง ูุนูู ุญุงููุงู:
- ุชุญููู ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ
- ุฏุนู WhatsApp Web ู API
- Fallback ูู API ุฅูู Web
- ุงุณุชุฎุฏุงู ููุงูุจ ุงูุฑุณุงุฆู

#### โ ุงููุดุงูู ุงูููุฌูุฏุฉ:

1. **ููุฏ ููุฑุฑ**
   - ููุณ ุงูููุฏ ููุฌูุฏ ูู ุฃูุงูู ุฃุฎุฑู
   - ูุง ููุฌุฏ service ููุญุฏ

2. **ุนุฏู ุชุณุฌูู ุงูุฅุฑุณุงู**
   - ูุง ูุชู ุญูุธ ุณุฌู ุฃู ุงููุงุชูุฑุฉ ุชู ุฅุฑุณุงููุง
   - ูุง ูููู ูุนุฑูุฉ ูุชู ุชู ุงูุฅุฑุณุงู

3. **ุนุฏู ุฏุนู Email**
   - ููุท WhatsApp
   - ูุง ูููู ุฅุฑุณุงู ูุงุชูุฑุฉ ุนุจุฑ Email

4. **ุนุฏู ูุฌูุฏ ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ**
   - ูุง ูููู ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฅุฑุณุงู
   - ูุง ูููู ุฅุฑุณุงู ุนุจุฑ ุฃูุซุฑ ูู ุทุฑููุฉ

---

### 3. ุฅุฑุณุงู ุทูุจุงุช ุงูุฅุตูุงุญ (`RepairDetailsPage.js`)

#### โ ูุง ูุนูู ุญุงููุงู:
- ุฅุฑุณุงู ุฑุณุงูุฉ ูุงุชุณุงุจ ุนูุฏ ุงุณุชูุงู ุงูุทูุจ
- ุงุณุชุฎุฏุงู ูุงูุจ ูู ุงูุฅุนุฏุงุฏุงุช

#### โ ุงููุดุงูู ุงูููุฌูุฏุฉ:

1. **ุฅุฑุณุงู ูุฏูู ููุท**
   - ูุง ููุฌุฏ ุฅุฑุณุงู ุชููุงุฆู ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ
   - ุงููุณุชุฎุฏู ูุฌุจ ุฃู ูุถุบุท ุฒุฑ ุงูุฅุฑุณุงู

2. **ุนุฏู ูุฌูุฏ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ**
   - ูุง ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ
   - ูุง ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุนูุฏ ุงูุชูุงู ุงูุชุดุฎูุต
   - ูุง ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุนูุฏ ุงูุชูุงู ุงูุฅุตูุงุญ

3. **ุนุฏู ุงุณุชุฎุฏุงู ุฌุฏูู RepairNotificationLog**
   - ุงูุฌุฏูู ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููู ูุง ููุณุชุฎุฏู
   - ูุง ููุฌุฏ ุชุณุฌูู ููุฅุดุนุงุฑุงุช

---

### 4. ุงูุนุฑูุถ ุงูุณุนุฑูุฉ (`QuotationsPage.js`)

#### โ ุงููุดุงูู ุงูููุฌูุฏุฉ:

1. **ูุง ููุฌุฏ ุฅุฑุณุงู ููุนุฑูุถ**
   - ูุง ุชูุฌุฏ ูุธููุฉ ูุฅุฑุณุงู ุนุฑุถ ุณุนุฑ ููุนููู
   - ูุง ููุฌุฏ ุฒุฑ ุฅุฑุณุงู ูู ุตูุญุฉ ุงูุนุฑูุถ

2. **ุนุฏู ูุฌูุฏ ููุงูุจ**
   - ูุง ุชูุฌุฏ ููุงูุจ ุฑุณุงุฆู ููุนุฑูุถ ุงูุณุนุฑูุฉ

---

### 5. ุชุฐููุฑุงุช ุงูุฏูุน (`OverduePaymentsPage.js`)

#### โ ุงููุดุงูู ุงูููุฌูุฏุฉ:

1. **ูุธููุฉ ุบูุฑ ููุชููุฉ**
   - `handleSendReminder` ููุฌูุฏ ููู ูุง ููุนู ุดูุก
   - ูุง ููุฌุฏ ููุฏ ุฅุฑุณุงู ูุนูู

2. **ุนุฏู ูุฌูุฏ ููุงูุจ**
   - ูุง ุชูุฌุฏ ููุงูุจ ุฑุณุงุฆู ูุชุฐููุฑุงุช ุงูุฏูุน

---

## ๐ฏ ุงูุชุทููุฑุงุช ุงููุทููุจุฉ

### 1. ุฅูุดุงุก ุฎุฏูุฉ ููุญุฏุฉ ูููุฑุงุณูุฉ

**ุงูููู ุงูููุชุฑุญ:** `frontend/react-app/src/services/messagingService.js`

**ุงูููุงู:**
- ุชุญููู ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ
- ุฅุฑุณุงู ุนุจุฑ WhatsApp (Web/API)
- ุฅุฑุณุงู ุนุจุฑ Email
- ุชุณุฌูู ูุญุงููุงุช ุงูุฅุฑุณุงู
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูู retry
- Fallback strategy

---

### 2. ุฅูุดุงุก API endpoints ููุฅุฑุณุงู

**ุงููููุงุช ุงูููุชุฑุญุฉ:**
- `backend/routes/messaging.routes.js`
- `backend/controllers/messaging.controller.js`
- `backend/services/messaging.service.js`

**ุงูููุงู:**
- ุฅุฑุณุงู ุฑุณุงุฆู WhatsApp ุนุจุฑ API
- ุฅุฑุณุงู ุฑุณุงุฆู Email
- ุชุณุฌูู ุงูุฅุฑุณุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฅุฏุงุฑุฉ ููุงูุจ ุงูุฑุณุงุฆู

---

### 3. ุฅูุดุงุก ุฌุฏูู ูุชุณุฌูู ุงููุฑุงุณูุงุช

**ุงูููู ุงูููุชุฑุญ:** `backend/migrations/create_messaging_log_table.sql`

**ุงูุฃุนูุฏุฉ ุงูููุชุฑุญุฉ:**
- id, entityType, entityId (invoice, repair, quotation, payment)
- channel (whatsapp, email, sms)
- recipient (phone/email)
- message, template
- status (pending, sent, delivered, failed)
- sentAt, deliveredAt, readAt
- errorMessage, retryCount
- metadata (JSON)

---

### 4. ุฅุถุงูุฉ ููุงูุจ ูุฌููุน ุงูุญุงูุงุช

**ุฅุถุงูุฉ ูู `MessagingSettingsPage.js`:**

- ููุงูุจ ุงูุนุฑูุถ ุงูุณุนุฑูุฉ
- ููุงูุจ ุชุฐููุฑุงุช ุงูุฏูุน
- ููุงูุจ ุฅุดุนุงุฑุงุช ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ
- ููุงูุจ ุฅุดุนุงุฑุงุช ุงูุชูุงู ุงูุฅุตูุงุญ
- ููุงูุจ ุฅุดุนุงุฑุงุช ุฌุงูุฒูุฉ ุงูุงุณุชูุงู

---

### 5. ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ

**ุงูููู ุงูููุชุฑุญ:** `backend/services/automationService.js`

**ุงูุญุงูุงุช ุงูุชู ุชุญุชุงุฌ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ:**

1. **ุทูุจุงุช ุงูุฅุตูุงุญ:**
   - ุงุณุชูุงู ุงูุทูุจ โ ุฅุฑุณุงู ุฑุณุงูุฉ ุชุฑุญูุจ
   - ุงูุชูุงู ุงูุชุดุฎูุต โ ุฅุฑุณุงู ุชูุงุตูู ุงูุชุดุฎูุต
   - ุฌุงูุฒูุฉ ุงูุนุฑุถ โ ุฅุฑุณุงู ุนุฑุถ ุงูุณุนุฑ
   - ุจุฏุก ุงูุฅุตูุงุญ โ ุฅุดุนุงุฑ ุงูุนููู
   - ุงูุชูุงู ุงูุฅุตูุงุญ โ ุฅุดุนุงุฑ ุฌุงูุฒูุฉ ุงูุงุณุชูุงู
   - ุฌุงูุฒ ููุงุณุชูุงู โ ุฅุดุนุงุฑ ููุงุฆู

2. **ุงูููุงุชูุฑ:**
   - ุฅูุดุงุก ูุงุชูุฑุฉ โ ุฅุฑุณุงู ุชููุงุฆู (ุงุฎุชูุงุฑู)
   - ุงุณุชูุงู ุฏูุนุฉ โ ุฅุดุนุงุฑ ุชุฃููุฏ
   - ุชุฃุฎุฑ ุงูุฏูุน โ ุชุฐููุฑ ุชููุงุฆู

3. **ุงูุนุฑูุถ ุงูุณุนุฑูุฉ:**
   - ุฅูุดุงุก ุนุฑุถ โ ุฅุฑุณุงู ุชููุงุฆู
   - ููุงููุฉ/ุฑูุถ โ ุฅุดุนุงุฑ

4. **ุงููุฏููุนุงุช:**
   - ุชุฃุฎุฑ ุงูุฏูุน โ ุชุฐููุฑ ุชููุงุฆู (ูููู/ุฃุณุจูุนู)

---

### 6. ุชุญุฏูุซ ุงููุงุฌูุงุช ูุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุงูุฅุฑุณุงู

**ุงูุตูุญุงุช ุงูุชู ุชุญุชุงุฌ ุชุญุฏูุซ:**

1. โ `InvoiceDetailsPage.js` - ุชู ุงูุชุญุฏูุซ
2. โ `QuotationDetailsPage.js` - ูุญุชุงุฌ ุฒุฑ ุฅุฑุณุงู
3. โ `RepairDetailsPage.js` - ูุญุชุงุฌ ุชุญุณูู (ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ)
4. โ `OverduePaymentsPage.js` - ูุญุชุงุฌ ุฅููุงู ูุธููุฉ ุงูุฅุฑุณุงู
5. โ `PaymentDetailsPage.js` - ูุญุชุงุฌ ุฒุฑ ุฅุฑุณุงู ุฅุดุนุงุฑ

---

### 7. ุฅุถุงูุฉ ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ ููุฅุฑุณุงู

**ุชุญุณููุงุช ููุชุฑุญุฉ:**

- ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฅุฑุณุงู (WhatsApp/Email/ููุงููุง)
- ุฅุฑุณุงู ูุฌูุน (Bulk send)
- ุฌุฏููุฉ ุงูุฅุฑุณุงู
- ุฅุฑุณุงู ุชููุงุฆู/ูุฏูู

---

## ๐ ุฃููููุงุช ุงูุชุทููุฑ

### ุงููุฑุญูุฉ 1: ุงูุฃุณุงุณูุงุช (ุฃููููุฉ ุนุงููุฉ)
1. โ ุฅูุดุงุก ุฎุฏูุฉ ููุญุฏุฉ ูููุฑุงุณูุฉ
2. โ ุฅูุดุงุก API endpoints ููุฅุฑุณุงู
3. โ ุฅูุดุงุก ุฌุฏูู ุชุณุฌูู ุงููุฑุงุณูุงุช
4. โ ุชุญุฏูุซ `InvoiceDetailsPage` ูุงุณุชุฎุฏุงู ุงูุฎุฏูุฉ ุงูููุญุฏุฉ

### ุงููุฑุญูุฉ 2: ุงูุชูุณุน (ุฃููููุฉ ูุชูุณุทุฉ)
1. ุฅุถุงูุฉ ุฏุนู Email
2. ุฅุถุงูุฉ ููุงูุจ ูุฌููุน ุงูุญุงูุงุช
3. ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุฅุฑุณุงู ูู ุฌููุน ุงูุตูุญุงุช
4. ุฅููุงู ูุธููุฉ ุชุฐููุฑุงุช ุงูุฏูุน

### ุงููุฑุญูุฉ 3: ุงูุฃุชูุชุฉ (ุฃููููุฉ ูุชูุณุทุฉ-ููุฎูุถุฉ)
1. ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ
2. ุฅุถุงูุฉ ุฌุฏููุฉ ุงูุฅุฑุณุงู
3. ุฅุถุงูุฉ retry mechanism
4. ุฅุถุงูุฉ ุชูุงุฑูุฑ ุงููุฑุงุณูุงุช

---

## ๐ง ุงูุชูุตูุงุช ุงูุชูููุฉ

### 1. ุงุณุชุฎุฏุงู Service Pattern
```javascript
// messagingService.js
class MessagingService {
  async sendInvoice(invoiceId, options = {}) {
    // Load settings
    // Prepare message
    // Send via selected channel
    // Log attempt
    // Return result
  }
}
```

### 2. ุงุณุชุฎุฏุงู Template Engine
```javascript
// templateService.js
class TemplateService {
  render(templateName, variables) {
    // Replace variables in template
    // Return rendered message
  }
}
```

### 3. ุงุณุชุฎุฏุงู Queue System (ูููุณุชูุจู)
- RabbitMQ / Bull Queue
- ูุฅุฑุณุงู ูุฌูุน
- ูุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

1. **ุงูุฃูุงู:**
   - ุชุดููุฑ API tokens ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุนุฏู ุนุฑุถ ุฃุฑูุงู ุงูููุงุชู ูู logs

2. **ุงูุฃุฏุงุก:**
   - Cache ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ
   - ุงุณุชุฎุฏุงู async/await ุจุดูู ุตุญูุญ
   - ุชุฌูุจ blocking operations

3. **ุงูุชุฌุฑุจุฉ:**
   - ุฅุถุงูุฉ loading states
   - ุฅุถุงูุฉ success/error notifications
   - ุฅุถุงูุฉ confirmation dialogs

---

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุฅูุดุงุก ุฎุฏูุฉ ููุญุฏุฉ ูููุฑุงุณูุฉ
- [ ] ุฅูุดุงุก API endpoints
- [ ] ุฅูุดุงุก ุฌุฏูู ุชุณุฌูู ุงููุฑุงุณูุงุช
- [ ] ุฅุถุงูุฉ ุฏุนู Email
- [ ] ุฅุถุงูุฉ ููุงูุจ ูุฌููุน ุงูุญุงูุงุช
- [ ] ุชุญุฏูุซ ุฌููุน ุงูุตูุญุงุช
- [ ] ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ
- [ ] ุฅุถุงูุฉ retry mechanism
- [ ] ุฅุถุงูุฉ ุชูุงุฑูุฑ ุงููุฑุงุณูุงุช
- [ ] ูุชุงุจุฉ tests

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-12
**ุงูุฅุตุฏุงุฑ:** 1.0.0

