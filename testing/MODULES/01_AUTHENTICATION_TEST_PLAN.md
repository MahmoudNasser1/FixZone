# ๐ ุฎุทุฉ ุงุฎุชุจุงุฑ ูุญุฏุฉ Authentication & Authorization
## Authentication & Authorization Module Testing Plan

**ุงูุชุงุฑูุฎ:** 2025-11-14  
**ุงููููุฏุณ:** Auto (Cursor AI) - QA Engineer  
**ุงูุฃุฏุงุฉ:** Chrome DevTools MCP  
**ุงูุฃููููุฉ:** ุญุฑุฌุฉ (Critical)  
**ุงูุญุฌู:** ุตุบูุฑ  
**ุงูุชุนููุฏ:** ูุชูุณุท

---

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุญุฏุฉ

### ุงููุตู:
ูุญุฏุฉ ุงููุตุงุฏูุฉ ูุงูุชูููุถ - ูุณุคููุฉ ุนู ุชุณุฌูู ุงูุฏุฎููุ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุชุ ูุงูุชุญูู ูู ุงูุตูุงุญูุงุช.

### ุงูููููุงุช:
- **Backend Routes:** 3 routes (login, register, me, logout, protected routes)
- **Frontend Pages:** 1 page (LoginPage)
- **Database Tables:** 3 tables (User, Role, UserLoginLog)
- **Middleware:** authMiddleware, authorizeMiddleware

---

## โ ุงูุฌูุงูุจ ุงูุฅูุฌุงุจูุฉ (Strengths)

### 1. โ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ
- โ ุงุณุชุฎุฏุงู JWT tokens ููุฃูุงู
- โ httpOnly cookies ูุชุฎุฒูู ุงูู token
- โ ุฏุนู ุชุณุฌูู ุงูุฏุฎูู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุฑูู ุงููุงุชู
- โ ุชุดููุฑ ูููุงุช ุงููุฑูุฑ ุจุงุณุชุฎุฏุงู bcrypt
- โ Middleware ูุงุถุญ ูููุธู

### 2. โ ุงูููุฒุงุช ุงููุชุงุญุฉ
- โ ุชุณุฌูู ุงูุฏุฎูู (login)
- โ ุชุณุฌูู ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ (register)
- โ ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู (/me)
- โ ุชุณุฌูู ุงูุฎุฑูุฌ (logout)
- โ ุญูุงูุฉ ุงููุณุงุฑุงุช (protected routes)
- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (authorization)

### 3. โ ุงูุฃูุงู
- โ ูููุงุช ุงููุฑูุฑ ูุดูุฑุฉ
- โ httpOnly cookies (ูุญูู ูู XSS)
- โ JWT tokens ูุน expiration
- โ Soft delete ูููุณุชุฎุฏููู (deletedAt)

---

## โ ุงูููุงูุต ูุงููุดุงูู (Gaps & Issues)

### 1. โ๏ธ ููุต ูู ุงูููุฒุงุช
- %#โ ูุง ููุฌุฏ "ูุณูุช ูููุฉ ุงููุฑูุฑ" (Forgot Password) ูุชุตู ูุจุงุดุฑู ุจ ุงููุฏูุฑ ุงููุณุฃูู
- %#โ ูุง ููุฌุฏ "ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ" (Reset Password) ูุชุตู ูุจุงุดุฑู ุจ ุงููุฏูุฑ ุงููุณุฃูู
- โ ูุง ููุฌุฏ "ุชุบููุฑ ูููุฉ ุงููุฑูุฑ" (Change Password)
- โ ูุง ููุฌุฏ "ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู" (Update Profile)
- %#โ ูุง ููุฌุฏ "ุชุฃููุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" (Email Verification)
- %#โ ูุง ููุฌุฏ "ุชุณุฌูู ุงูุฏุฎูู ุจู OAuth" (Google, Facebook)
- %#โ ูุง ููุฌุฏ "Two-Factor Authentication" (2FA)

### 2. โ๏ธ ูุดุงูู ุฃูููุฉ ูุญุชููุฉ
- โ๏ธ JWT_SECRET hardcoded (ูุฌุจ ุฃู ูููู ูู environment variables)
- โ๏ธ ูุง ููุฌุฏ rate limiting ุนูู login endpoint
- โ๏ธ ูุง ููุฌุฏ account lockout ุจุนุฏ ูุญุงููุงุช ูุงุดูุฉ
- โ๏ธ ูุง ููุฌุฏ session management (ูุง ูููู ุฅูุบุงุก ุฌูุณุงุช ูุดุทุฉ)
- โ๏ธ ูุง ููุฌุฏ logging ูููุญุงููุงุช ุงููุงุดูุฉ ูู UserLoginLog

### 3. โ๏ธ ูุดุงูู ูู ุงููุงุฌูุฉ
- โ๏ธ ุฑุงุจุท "Forgot password?" ููุฌูุฏ ููู ูุง ูุนูู 
- โ๏ธ ูุง ููุฌุฏ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู
- โ๏ธ ูุง ููุฌุฏ loading indicator ุฃุซูุงุก ุชุณุฌูู ุงูุฏุฎูู
- โ๏ธ ูุง ููุฌุฏ validation ููุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุฑูู ุงููุงุชู ูู ุงููุงุฌูุฉ

### 4. โ๏ธ ูุดุงูู ูู ุงูู Backend
- โ๏ธ ุงุณุชุฎุฏุงู `db.query` ุจุฏูุงู ูู `db.execute` ูู ุจุนุถ ุงูุฃูุงูู
- โ๏ธ ูุง ููุฌุฏ input validation ุจุงุณุชุฎุฏุงู Joi ุฃู express-validator
- โ๏ธ ุฑุณุงุฆู ุงูุฎุทุฃ ุบูุฑ ูุงุถุญุฉ (Invalid credentials ูุฌููุน ุงูุญุงูุงุช)
- โ๏ธ ูุง ููุฌุฏ error handling ุดุงูู

### 5. โ๏ธ ูุดุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ๏ธ ุฌุฏูู UserLoginLog ููุฌูุฏ ููู ูุง ููุณุชุฎุฏู
- โ๏ธ ูุง ููุฌุฏ index ุนูู email ู phone ูู ุฌุฏูู User
- โ๏ธ ูุง ููุฌุฏ constraint ูููุน email duplicates (ูุน soft delete)

---

## ๐ก ุงูุชุฑุงุญุงุช ุงูุชุญุณูู ูุงูุชุทููุฑ (Improvements & Enhancements)

### 1. ๐ ุชุญุณููุงุช ุฃูููุฉ (Security Enhancements)
1. **Rate Limiting:**
   - ุฅุถุงูุฉ rate limiting ุนูู `/api/auth/login`
   - ุงูุญุฏ: 5 ูุญุงููุงุช ูู 15 ุฏูููุฉ

2. %#**Account Lockout:**
   - ููู ุงูุญุณุงุจ ุจุนุฏ 5 ูุญุงููุงุช ูุงุดูุฉ
   - ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุณุชุฎุฏู

3. **Session Management:**
   - ุฅุถุงูุฉ ุฌุฏูู Sessions
   - ุฅููุงููุฉ ุนุฑุถ ูุฅูุบุงุก ุงูุฌูุณุงุช ุงููุดุทุฉ
   - ุชุณุฌูู ุงูุฎุฑูุฌ ูู ุฌููุน ุงูุฃุฌูุฒุฉ

4. %#**Two-Factor Authentication:**
   - ุฅุถุงูุฉ 2FA ุงุฎุชูุงุฑู
   - ุงุณุชุฎุฏุงู TOTP (Google Authenticator)

5. %#**Password Policy:**
   - ููุฉ ูููุฉ ุงููุฑูุฑ (8+ chars, uppercase, lowercase, numbers, symbols)
   - ุฅุฌุจุงุฑ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุจุนุฏ ูุชุฑุฉ ูุนููุฉ

### 2. ๐ ููุฒุงุช ุฌุฏูุฏุฉ (New Features)
1. **Forgot/Reset Password:**
   %#- ุฑุงุจุท "ูุณูุช ูููุฉ ุงููุฑูุฑ"
   %#- ุฅุฑุณุงู ุฑูุฒ ุฅุนุงุฏุฉ ุชุนููู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   %#- ุตูุญุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
   ุงูุงุชุตุงู ุจ ุงููุฏูุฑ ุงููุณุฃูู

2. %#**Change Password:**
   %#- ุตูุญุฉ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
   %#- ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉ
   %#- ุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ

3. **Profile Management:**
   - ุตูุญุฉ ุงูููู ุงูุดุฎุตู
   - ุชุญุฏูุซ ุงููุนูููุงุช ุงูุดุฎุตูุฉ
   - ุฑูุน ุตูุฑุฉ ุงูููู ุงูุดุฎุตู

4. %#**Email Verification:**
   - ุฅุฑุณุงู ุฑุงุจุท ุงูุชูุนูู ุนูุฏ ุงูุชุณุฌูู
   - ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ุฅุฌุจุงุฑ ุงูุชุญูู ูุจู ุชุณุฌูู ุงูุฏุฎูู

5. %#**OAuth Integration:**
   - ุชุณุฌูู ุงูุฏุฎูู ุจู Google
   - ุชุณุฌูู ุงูุฏุฎูู ุจู Facebook
   - ุฑุจุท ุญุณุงุจุงุช ุฎุงุฑุฌูุฉ

### 3. ๐ ุชุญุณููุงุช UX/UI
1. **Loading States:**
   - ุฅุถุงูุฉ loading indicator ุฃุซูุงุก ุชุณุฌูู ุงูุฏุฎูู
   - ุชุนุทูู ุงูุญููู ุฃุซูุงุก ุงููุนุงูุฌุฉ

2. **Error Messages:**
   - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ
   - ุฑุณุงุฆู ุจุงูุนุฑุจูุฉ
   - ุนุฑุถ ุฃุฎุทุงุก ุงูุชุญูู (validation errors)

3. **Success Feedback:**
   - ุฑุณุงุฆู ูุฌุงุญ ูุงุถุญุฉ
   - Redirect ุณูุณ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

4. **Form Validation:**
   - ุงูุชุญูู ูู ุงูููุช ุงููุนูู (real-time validation)
   - ุฑุณุงุฆู ุชุญูู ูุงุถุญุฉ
   - ููุน ุงูุฅุฑุณุงู ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ

### 4. ๐ ุชุญุณููุงุช Backend
1. **Input Validation:**
   - ุงุณุชุฎุฏุงู Joi ุฃู express-validator
   - ุงูุชุญูู ูู ุตุญุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ุงูุชุญูู ูู ุตุญุฉ ุฑูู ุงููุงุชู
   - ุงูุชุญูู ูู ููุฉ ูููุฉ ุงููุฑูุฑ

2. **Error Handling:**
   - ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
   - ุณุฌูุงุช ูุงุถุญุฉ ููุฃุฎุทุงุก
   - ุฑุณุงุฆู ุฎุทุฃ ูููุฏุฉ

3. **Database Optimization:**
   - ุงุณุชุฎุฏุงู `db.execute` ุจุฏูุงู ูู `db.query`
   - ุฅุถุงูุฉ indexes ุนูู email ู phone
   - ุฅุถุงูุฉ unique constraint ุนูู email (ูุน soft delete)

4. **Logging:**
   - ุชุณุฌูู ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ูู UserLoginLog
   - ุชุณุฌูู ุงููุญุงููุงุช ุงููุงุดูุฉ
   - ุชุณุฌูู ุชุณุฌููุงุช ุงูุฎุฑูุฌ

---

## ๐งช ุฎุทุฉ ุงูุงุฎุชุจุงุฑ ุงูุชูุตูููุฉ

### ุงููุฑุญูุฉ 1: ุงุฎุชุจุงุฑ ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ (Functional Testing)

#### 1.1 ุชุณุฌูู ุงูุฏุฎูู (Login)
**ุงูุฃููููุฉ:** ุญุฑุฌุฉ  
**ุงูููุช ุงูููุฏุฑ:** 30 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
   - ุงูุฅุฏุฎุงู: email ุตุญูุญ + password ุตุญูุญ
   - ุงููุชููุน: ุชุณุฌูู ุฏุฎูู ูุงุฌุญุ redirect ููู dashboard
   - ุงูุชุญูู: cookie ููุฌูุฏุ user data ูู store

2. **โ ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ ุจุฑูู ุงููุงุชู**
   - ุงูุฅุฏุฎุงู: phone ุตุญูุญ + password ุตุญูุญ
   - ุงููุชููุน: ุชุณุฌูู ุฏุฎูู ูุงุฌุญุ redirect ููู dashboard
   - ุงูุชุญูู: cookie ููุฌูุฏุ user data ูู store

3. **โ ุชุณุฌูู ุงูุฏุฎูู ุจูููุฉ ูุฑูุฑ ุฎุงุทุฆุฉ**
   - ุงูุฅุฏุฎุงู: email/phone ุตุญูุญ + password ุฎุงุทุฆ
   - ุงููุชููุน: ุฑุณุงูุฉ ุฎุทุฃ "Invalid credentials"
   - ุงูุชุญูู: ูุง ููุฌุฏ cookieุ ูุง ููุฌุฏ redirect

4. **โ ุชุณุฌูู ุงูุฏุฎูู ุจูุณุชุฎุฏู ุบูุฑ ููุฌูุฏ**
   - ุงูุฅุฏุฎุงู: email/phone ุบูุฑ ููุฌูุฏ + password
   - ุงููุชููุน: ุฑุณุงูุฉ ุฎุทุฃ "Invalid credentials"
   - ุงูุชุญูู: ูุง ููุฌุฏ cookie

5. **โ ุชุณุฌูู ุงูุฏุฎูู ุจุญููู ูุงุฑุบุฉ**
   - ุงูุฅุฏุฎุงู: fields ูุงุฑุบุฉ
   - ุงููุชููุน: ุฑุณุงูุฉ ุฎุทุฃ "Please provide login identifier and password"
   - ุงูุชุญูู: ููุน ุงูุฅุฑุณุงู

6. **โ ุชุณุฌูู ุงูุฏุฎูู ุจูุณุชุฎุฏู ูุญุฐูู (soft delete)**
   - ุงูุฅุฏุฎุงู: email/phone ููุณุชุฎุฏู ูุญุฐูู
   - ุงููุชููุน: ุฑุณุงูุฉ ุฎุทุฃ "Invalid credentials"
   - ุงูุชุญูู: ูุง ูููู ุชุณุฌูู ุงูุฏุฎูู

#### %# 1.2 ุชุณุฌูู ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ (Register)
**ุงูุฃููููุฉ:** ูุชูุณุทุฉ  
**ุงูููุช ุงูููุฏุฑ:** 20 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ ุจูุฌุงุญ**
   - ุงูุฅุฏุฎุงู: ุจูุงูุงุช ุตุญูุญุฉ ููุงููุฉ
   - ุงููุชููุน: ุฅูุดุงุก ุญุณุงุจ ูุงุฌุญุ ุชุณุฌูู ุฏุฎูู ุชููุงุฆู
   - ุงูุชุญูู: user ุฌุฏูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

2. **โ ุชุณุฌูู ูุณุชุฎุฏู ุจุจุฑูุฏ ุฅููุชุฑููู ููุฌูุฏ**
   - ุงูุฅุฏุฎุงู: email ููุฌูุฏ ูุณุจูุงู
   - ุงููุชููุน: ุฑุณุงูุฉ ุฎุทุฃ "Email already exists"
   - ุงูุชุญูู: ูุง ูุชู ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ

3. **โ ุชุณุฌูู ูุณุชุฎุฏู ุจุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ**
   - ุงูุฅุฏุฎุงู: email ุบูุฑ ุตุญูุญุ password ุถุนูู
   - ุงููุชููุน: ุฑุณุงุฆู ุชุญูู ูุงุถุญุฉ
   - ุงูุชุญูู: ูุง ูุชู ุฅูุดุงุก ุญุณุงุจ

#### 1.3 ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู (/me)
**ุงูุฃููููุฉ:** ุนุงููุฉ  
**ุงูููุช ุงูููุฏุฑ:** 15 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู ูุน token ุตุญูุญ**
   - ุงูุฅุฏุฎุงู: request ูุน valid token
   - ุงููุชููุน: ุฅุฑุฌุงุน ุจูุงูุงุช ุงููุณุชุฎุฏู (id, name, role)
   - ุงูุชุญูู: ุงูุจูุงูุงุช ุตุญูุญุฉ

2. **โ ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู ุจุฏูู token**
   - ุงูุฅุฏุฎุงู: request ุจุฏูู token
   - ุงููุชููุน: 401 Unauthorized
   - ุงูุชุญูู: ูุง ูุชู ุฅุฑุฌุงุน ุงูุจูุงูุงุช

3. **โ ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุน token ุบูุฑ ุตุญูุญ**
   - ุงูุฅุฏุฎุงู: request ูุน invalid token
   - ุงููุชููุน: 401 Unauthorized
   - ุงูุชุญูู: ูุง ูุชู ุฅุฑุฌุงุน ุงูุจูุงูุงุช

#### 1.4 ุชุณุฌูู ุงูุฎุฑูุฌ (Logout)
**ุงูุฃููููุฉ:** ุนุงููุฉ  
**ุงูููุช ุงูููุฏุฑ:** 15 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ**
   - ุงูุฅุฏุฎุงู: request logout
   - ุงููุชููุน: ุญุฐู cookieุ redirect ููุตูุญุฉ login
   - ุงูุชุญูู: ูุง ูููู ุงููุตูู ูุตูุญุงุช ูุญููุฉ

### ุงููุฑุญูุฉ 2: ุงุฎุชุจุงุฑ ุงูุฃูุงู (Security Testing)

#### 2.1 ุญูุงูุฉ ุงููุณุงุฑุงุช (Route Protection)
**ุงูุฃููููุฉ:** ุญุฑุฌุฉ  
**ุงูููุช ุงูููุฏุฑ:** 30 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ุงููุตูู ูุตูุญุฉ ูุญููุฉ ูุน token ุตุญูุญ**
   - ุงูุฅุฏุฎุงู: request ูุตูุญุฉ ูุญููุฉ ูุน valid token
   - ุงููุชููุน: ุงููุตูู ูุณููุญ
   - ุงูุชุญูู: ุงูุตูุญุฉ ุชูุนุฑุถ

2. **โ ุงููุตูู ูุตูุญุฉ ูุญููุฉ ุจุฏูู token**
   - ุงูุฅุฏุฎุงู: request ูุตูุญุฉ ูุญููุฉ ุจุฏูู token
   - ุงููุชููุน: 401 Unauthorizedุ redirect ููุตูุญุฉ login
   - ุงูุชุญูู: ูุง ูููู ุงููุตูู

3. **โ ุงููุตูู ูุตูุญุฉ ูุญููุฉ ูุน token ููุชูู**
   - ุงูุฅุฏุฎุงู: request ูุน expired token
   - ุงููุชููุน: 401 Unauthorized
   - ุงูุชุญูู: redirect ููุตูุญุฉ login

#### 2.2 ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (Authorization)
**ุงูุฃููููุฉ:** ุนุงููุฉ  
**ุงูููุช ุงูููุฏุฑ:** 30 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ูุตูู Admin ูุตูุญุฉ Admin-only**
   - ุงูุฅุฏุฎุงู: request ูู admin
   - ุงููุชููุน: ุงููุตูู ูุณููุญ
   - ุงูุชุญูู: ุงูุตูุญุฉ ุชูุนุฑุถ

2. **โ ูุตูู User ุนุงุฏู ูุตูุญุฉ Admin-only**
   - ุงูุฅุฏุฎุงู: request ูู user ุนุงุฏู
   - ุงููุชููุน: 403 Forbidden
   - ุงูุชุญูู: ูุง ูููู ุงููุตูู

### ุงููุฑุญูุฉ 3: ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก (Performance Testing)

#### 3.1 ุฃุฏุงุก ุชุณุฌูู ุงูุฏุฎูู
**ุงูุฃููููุฉ:** ูุชูุณุทุฉ  
**ุงูููุช ุงูููุฏุฑ:** 20 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ ููุช ุงุณุชุฌุงุจุฉ ุชุณุฌูู ุงูุฏุฎูู < 2 ุซุงููุฉ**
   - ุงูุฅุฏุฎุงู: login request
   - ุงููุชููุน: response time < 2s
   - ุงูุชุญูู: ููุงุณ ุงูููุช

2. **โ ุฃุฏุงุก ุชุณุฌูู ุงูุฏุฎูู ุชุญุช ุงูุญูู**
   - ุงูุฅุฏุฎุงู: 10 requests ูุชุฒุงููุฉ
   - ุงููุชููุน: ุฌููุน ุงูุทูุจุงุช ุชูุฌุญ
   - ุงูุชุญูู: ูุง ููุฌุฏ errors

### ุงููุฑุญูุฉ 4: ุงุฎุชุจุงุฑ ุงูุชูุงูู (Integration Testing)

#### 4.1 ุชูุงูู ูุน Dashboard
**ุงูุฃููููุฉ:** ุนุงููุฉ  
**ุงูููุช ุงูููุฏุฑ:** 20 ุฏูููุฉ

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:**

1. **โ Redirect ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู**
   - ุงูุฅุฏุฎุงู: login successful
   - ุงููุชููุน: redirect ููู dashboard
   - ุงูุชุญูู: ุงูุตูุญุฉ ุงูุตุญูุญุฉ

2. **โ ุชุญููู ุจูุงูุงุช Dashboard ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู**
   - ุงูุฅุฏุฎุงู: access dashboard
   - ุงููุชููุน: ุชุญููู ุงูุจูุงูุงุช ุจูุฌุงุญ
   - ุงูุชุญูู: ุงูุจูุงูุงุช ุชูุนุฑุถ ุจุดูู ุตุญูุญ

---

## ๐ ูุนุงููุฑ ุงููุจูู (Acceptance Criteria)

### โ ูุนุงููุฑ ุฅูุฒุงููุฉ (Must Have):
- [ ] ุชุณุฌูู ุงูุฏุฎูู ูุนูู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- [ ] ุชุณุฌูู ุงูุฏุฎูู ูุนูู ุจุฑูู ุงููุงุชู
- [ ] ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- [ ] ุญูุงูุฉ ุงููุณุงุฑุงุช ุชุนูู ุจุดูู ุตุญูุญ
- [ ] JWT tokens ุชุนูู ุจุดูู ุตุญูุญ
- [ ] httpOnly cookies ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ููุช ุงุณุชุฌุงุจุฉ < 2 ุซุงููุฉ

### โ๏ธ ูุนุงููุฑ ูุณุชุญุณูุฉ (Should Have):
- [ ] Rate limiting ุนูู login
- [ ] Input validation ูุงุถุญ
- [ ] Loading indicators
- [ ] Error handling ุดุงูู

### ๐ก ูุนุงููุฑ ุฅุถุงููุฉ (Nice to Have):
- [ ] Forgot password
- [ ] Change password
- [ ] Profile management
- [ ] OAuth integration
- [ ] 2FA

---

## ๐ ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ ุงูุชูุตูููุฉ ุจุงุณุชุฎุฏุงู Chrome DevTools MCP

### Scenario 1: Login Successful
**Steps:**
1. Navigate to `/login`
2. Fill email: `admin@fixzone.com`
3. Fill password: `admin123`
4. Click "Sign in"
5. Verify redirect to dashboard
6. Verify cookie is set
7. Verify user data in store

**Expected:**
- Status: 200 OK
- Cookie: `token` exists
- Redirect: `/dashboard`
- User data: `{id, name, role}`

---

### Scenario 2: Login Failed - Wrong Password
**Steps:**
1. Navigate to `/login`
2. Fill email: `admin@fixzone.com`
3. Fill password: `wrongpassword`
4. Click "Sign in"
5. Verify error message

**Expected:**
- Status: 401 Unauthorized
- Error: "Invalid credentials"
- No cookie set
- No redirect

---

### Scenario 3: Access Protected Route Without Token
**Steps:**
1. Clear cookies
2. Navigate to `/repairs`
3. Verify redirect

**Expected:**
- Status: 401 Unauthorized
- Redirect: `/login`
- No access to protected route

---

## ๐ ุฌุฏูู ุงูุงุฎุชุจุงุฑ

| # | Test Case | Priority | Status | Notes |
|---|-----------|----------|--------|-------|
| 1 | Login wุกith email | Critical | โณ Pending | |
| 2 | Login with phone | Critical | โณ Pending | |
| 3 | Login with wrong password | Critical | โณ Pending | |
| 4 | Login with non-existent user | High | โณ Pending | |
| 5 | Login with empty fields | High | โณ Pending | |
| 6 | Register new user | Medium | โณ Pending | |
| 7 | Register with existing email | Medium | โณ Pending | |
| 8 | Get current user (/me) | High | โณ Pending | |
| 9 | Logout | High | โณ Pending | |
| 10 | Access protected route | Critical | โณ Pending | |
| 11 | Access admin-only route | High | โณ Pending | |
| 12 | Performance test | Medium | โณ Pending | |

---

**ููุงุญุธุฉ:** ุณูุชู ุชูููุฐ ูุฐู ุงูุงุฎุชุจุงุฑุงุช ุจุงุณุชุฎุฏุงู Chrome DevTools MCP ูุณูุชู ุชูุซูู ุงููุชุงุฆุฌ ูู ููู ูููุตู.

---

## ๐ง ุงูุฅุตูุงุญุงุช ุงูููุชููุฉ (Fixes Completed)

**ุงูุชุงุฑูุฎ:** 2025-11-14  
**ุงููููุฏุณ:** Auto (Cursor AI)  

### โ ุงูุฅุตูุงุญุงุช ูู Backend:

1. **โ ุงุณุชุฎุฏุงู db.execute ุจุฏูุงู ูู db.query:**
   - ุชู ุงุณุชุจุฏุงู ุฌููุน `db.query` ุจู `db.execute` ูู `authController.js`
   - ุชุญุณูู ุงูุฃูุงู ูุงูุญูุงูุฉ ูู SQL injection

2. **โ Input Validation ุจุงุณุชุฎุฏุงู Joi:**
   - ุฅุถุงูุฉ validation schemas ูุฌููุน routes (login, register, changePassword, updateProfile)
   - ุฑุณุงุฆู ุชุญูู ูุงุถุญุฉ ููููุฏุฉ
   - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุดุงูู

3. **โ ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ:**
   - "User not found" (404) ุจุฏูุงู ูู "Invalid credentials"
   - "Incorrect password" (401) ุจุฏูุงู ูู "Invalid credentials"
   - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูุฌููุน ุงูุนูููุงุช

4. **โ Rate Limiting ุนูู login endpoint:**
   - ุฅุถุงูุฉ express-rate-limit
   - 5 ูุญุงููุงุช ูู 15 ุฏูููุฉ
   - ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ุนูุฏ ุชุฌุงูุฒ ุงูุญุฏ

5. **โ Logging ูููุญุงููุงุช:**
   - ุงุณุชุฎุฏุงู `UserLoginLog` table
   - ุชุณุฌูู ุฌููุน ุงููุญุงููุงุช (ูุงุฌุญุฉ ู ูุงุดูุฉ)
   - ุชุณุฌูู IP address ู User Agent

6. **โ Database Indexes:**
   - ุฅุถุงูุฉ index ุนูู phone column
   - ุฅุถุงูุฉ index ุนูู deletedAt column
   - ุชุญุณูู ุฃุฏุงุก ุงูุจุญุซ

7. **โ Environment Variables:**
   - ุงุณุชุฎุฏุงู `process.env.JWT_SECRET`
   - Error ูู production ุฅุฐุง ูู ููู ููุฌูุฏ
   - `.env.example` file ููุชูุซูู

8. **โ Change Password Functionality:**
   - ุฅุถุงูุฉ `changePassword` controller
   - ุฅุถุงูุฉ `/change-password` route
   - ุงูุชุญูู ูู current password
   - ุชุญุฏูุซ password ูู database

9. **โ Profile Management:**
   - ุฅุถุงูุฉ `getProfile` ู `updateProfile` controllers
   - ุฅุถุงูุฉ `/profile` routes (GET, PUT)
   - ุชุญุฏูุซ name, email, phone
   - ุงูุชุญูู ูู email uniqueness

### โณ ุงูุฅุตูุงุญุงุช ุงููุชุจููุฉ (Frontend):

1. **โณ Loading Indicators:**
   - ุฅุถุงูุฉ loading indicator ุฃุซูุงุก ุชุณุฌูู ุงูุฏุฎูู
   - ุชุนุทูู ุงูุญููู ุฃุซูุงุก ุงููุนุงูุฌุฉ

2. **โณ Error Messages:**
   - ุชุญุณูู ุนุฑุถ ุฑุณุงุฆู ุงูุฎุทุฃ
   - ุฑุณุงุฆู ุจุงูุนุฑุจูุฉ
   - ุนุฑุถ ุฃุฎุทุงุก ุงูุชุญูู (validation errors)

3. **โณ Form Validation:**
   - ุงูุชุญูู ูู ุงูููุช ุงููุนูู (real-time validation)
   - ุฑุณุงุฆู ุชุญูู ูุงุถุญุฉ
   - ููุน ุงูุฅุฑุณุงู ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ

4. **โณ recharts Issue:**
   - ุฅุตูุงุญ ูุดููุฉ recharts ุงูุชู ุชููุน ุนุฑุถ LoginPage

---

**ููุงุญุธุฉ:** ุงูุณุทูุฑ ุงูุชู ุชุญุชูู ุนูู %# ูู ููุงู ูุคุฌูุฉ (ูุชู ุชุฌุงูููุง)

**ููุงุญุธุฉ:** ุชู ุฅููุงู ุฌููุน ุงูุฅุตูุงุญุงุช ูู Backend. Frontend fixes ููุฏ ุงูุชูููุฐ.

