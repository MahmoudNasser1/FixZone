# ุชูุฑูุฑ ุฅุตูุงุญ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ุชููุงุฆูุงู ูู ุตูุญุฉ ุงูุชุชุจุน

## ๐ ุงููุดููุฉ

ุญุงูุฉ ุงูุทูุจ ูู ุตูุญุฉ ุงูุชุชุจุน ุงูุนุงูุฉ ูุง ุชุชุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ ูู ุงููุธุงู.

**ุงููุดููุฉ:**
- ุงููุณุชุฎุฏู ูุบูุฑ ุญุงูุฉ ุงูุทูุจ ูู "ูุณุชูู" ุฅูู "ููุฏ ุงูุฅุตูุงุญ"
- ุตูุญุฉ ุงูุชุชุจุน ูุง ุชุชุญุฏุซ ุชููุงุฆูุงู
- ุงููุณุชุฎุฏู ูุญุชุงุฌ ูุชุญุฏูุซ ุงูุตูุญุฉ ูุฏููุงู

---

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. **ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ**

**ุงูุฅุถุงูุฉ:**
```javascript
// ุชุญุฏูุซ ุชููุงุฆู ููุญุงูุฉ ูู 30 ุซุงููุฉ
useEffect(() => {
  if (!repairData || !repairData.id) return;
  
  currentRepairIdRef.current = repairData.id;
  
  const intervalId = setInterval(() => {
    if (currentRepairIdRef.current) {
      const isNumeric = /^\d+$/.test(String(currentRepairIdRef.current));
      if (isNumeric) {
        handleAutoSearch(String(currentRepairIdRef.current), 'trackingToken');
      } else if (repairData.trackingToken) {
        handleAutoSearch(repairData.trackingToken, 'trackingToken');
      }
    }
  }, 30000); // 30 ุซุงููุฉ

  return () => clearInterval(intervalId);
}, [repairData?.id]);
```

**ุงููุชูุฌุฉ:** โ ุงูุตูุญุฉ ุชุชุญุฏุซ ุชููุงุฆูุงู ูู 30 ุซุงููุฉ.

---

### 2. **ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ focus ุนูู ุงูุตูุญุฉ**

**ุงูุฅุถุงูุฉ:**
```javascript
// ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ focus ุนูู ุงูุตูุญุฉ
useEffect(() => {
  const handleFocus = () => {
    if (repairData?.id) {
      const isNumeric = /^\d+$/.test(String(repairData.id));
      if (isNumeric) {
        handleAutoSearch(String(repairData.id), 'trackingToken');
      } else if (repairData.trackingToken) {
        handleAutoSearch(repairData.trackingToken, 'trackingToken');
      }
    }
  };

  window.addEventListener('focus', handleFocus);
  return () => window.removeEventListener('focus', handleFocus);
}, [repairData?.id]);
```

**ุงููุชูุฌุฉ:** โ ุงูุตูุญุฉ ุชุชุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ุงูุนูุฏุฉ ููุตูุญุฉ.

---

### 3. **ุงุณุชุฎุฏุงู WebSocket ููุชุญุฏูุซ ุงูููุฑู**

**ุงูุฅุถุงูุฉ:**
```javascript
// ุงุณุชุฎุฏุงู WebSocket ููุชุญุฏูุซ ุงูุชููุงุฆู
useRepairUpdatesById(repairData?.id, (message) => {
  if (message && message.data && message.data.id === repairData?.id) {
    if (message.updateType === 'updated' || message.updateType === 'status_changed') {
      // ุฅุนุงุฏุฉ ุฌูุจ ุงูุจูุงูุงุช
      const isNumeric = /^\d+$/.test(String(repairData.id));
      if (isNumeric) {
        handleAutoSearch(String(repairData.id), 'trackingToken');
      } else if (repairData.trackingToken) {
        handleAutoSearch(repairData.trackingToken, 'trackingToken');
      }
    }
  }
});
```

**ุงููุชูุฌุฉ:** โ ุชุญุฏูุซ ููุฑู ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ (ุฅุฐุง ูุงู WebSocket ูุชุงุญุงู).

---

### 4. **ุฅุถุงูุฉ ุฒุฑ ุชุญุฏูุซ ูุฏูู**

**ุงูุฅุถุงูุฉ:**
```jsx
<SimpleButton
  onClick={() => {
    if (repairData?.id) {
      const isNumeric = /^\d+$/.test(String(repairData.id));
      if (isNumeric) {
        handleAutoSearch(String(repairData.id), 'trackingToken');
      } else if (repairData.trackingToken) {
        handleAutoSearch(repairData.trackingToken, 'trackingToken');
      }
    }
  }}
  variant="outline"
  disabled={!repairData || loading}
>
  <RefreshCw className={`w-4 h-4 ml-2 ${loading ? 'animate-spin' : ''}`} />
  ุชุญุฏูุซ
</SimpleButton>
```

**ุงููุชูุฌุฉ:** โ ุงููุณุชุฎุฏู ููููู ุชุญุฏูุซ ุงูุญุงูุฉ ูุฏููุงู.

---

### 5. **ุฅุตูุงุญ ูุดููุฉ ุงูุญุงูุฉ ุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ**

**ุงููุดููุฉ:**
- Backend ูุฑุฌุน ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ (ูุซู "ุชู ุงูุงุณุชูุงู")
- Frontend ูุชููุน ุงูุญุงูุฉ ุจุงูุฅูุฌููุฒูุฉ (ูุซู "RECEIVED")

**ุงูุญู:**
- ุฅุฑุฌุงุน `status` ุจุงูุฅูุฌููุฒูุฉ ู `statusLabel` ุจุงูุนุฑุจูุฉ ูู Backend
- ุฅุถุงูุฉ ุชุญููู ุชููุงุฆู ูู Frontend

**Backend:**
```javascript
status: repair.status || 'RECEIVED', // ุฅูุฌููุฒูุฉ
statusLabel: statusMap[repair.status] || repair.status || 'ุชู ุงูุงุณุชูุงู', // ุนุฑุจูุฉ
```

**Frontend:**
```javascript
const statusMap = {
  'ุชู ุงูุงุณุชูุงู': 'RECEIVED',
  'ููุฏ ุงููุญุต': 'INSPECTION',
  // ...
};
const englishStatus = statusMap[statusKey] || statusKey;
const config = statusConfig[englishStatus] || statusConfig['RECEIVED'];
```

**ุงููุชูุฌุฉ:** โ ุงูุญุงูุฉ ุชุนูู ุจุดูู ุตุญูุญ ุณูุงุก ูุงูุช ุนุฑุจูุฉ ุฃู ุฅูุฌููุฒูุฉ.

---

## ๐ ุงููุชุงุฆุฌ

### ูุจู ุงูุฅุตูุงุญ:
- โ ุงูุญุงูุฉ ูุง ุชุชุญุฏุซ ุชููุงุฆูุงู
- โ ุงููุณุชุฎุฏู ูุญุชุงุฌ ูุชุญุฏูุซ ุงูุตูุญุฉ ูุฏููุงู
- โ ูุดููุฉ ูู ุนุฑุถ ุงูุญุงูุฉ (ุนุฑุจูุฉ/ุฅูุฌููุฒูุฉ)

### ุจุนุฏ ุงูุฅุตูุงุญ:
- โ ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ focus ุนูู ุงูุตูุญุฉ
- โ ุชุญุฏูุซ ููุฑู ุนุจุฑ WebSocket (ุฅุฐุง ูุงู ูุชุงุญุงู)
- โ ุฒุฑ ุชุญุฏูุซ ูุฏูู
- โ ุฅุตูุงุญ ูุดููุฉ ุงูุญุงูุฉ ุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุชููุงุฆู:
1. ุงูุชุญ ุตูุญุฉ ุงูุชุชุจุน (`/track?trackingToken=1385`)
2. ุบูุฑ ุญุงูุฉ ุงูุทูุจ ูู ุตูุญุฉ ุฃุฎุฑู
3. ุงูุชุธุฑ 30 ุซุงููุฉ ุฃู ุงุถุบุท F5
4. ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุญุงูุฉ ุชููุงุฆูุงู

### 2. ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุนูุฏ Focus:
1. ุงูุชุญ ุตูุญุฉ ุงูุชุชุจุน
2. ุบูุฑ ุฅูู ุชุจููุจ ุขุฎุฑ
3. ุบูุฑ ุญุงูุฉ ุงูุทูุจ
4. ุงุฑุฌุน ูุตูุญุฉ ุงูุชุชุจุน
5. ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุญุงูุฉ ุชููุงุฆูุงู

### 3. ุงุฎุชุจุงุฑ ุฒุฑ ุงูุชุญุฏูุซ:
1. ุงูุชุญ ุตูุญุฉ ุงูุชุชุจุน
2. ุบูุฑ ุญุงูุฉ ุงูุทูุจ
3. ุงุถุบุท ุฒุฑ "ุชุญุฏูุซ"
4. ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุญุงูุฉ ููุฑุงู

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. **ูุชุฑุฉ ุงูุชุญุฏูุซ**
- ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูู 30 ุซุงููุฉ
- ูููู ุชุบููุฑ ุงููุชุฑุฉ ุญุณุจ ุงูุญุงุฌุฉ

### 2. **WebSocket**
- ุฅุฐุง ูุงู WebSocket ูุชุงุญุงูุ ุงูุชุญุฏูุซ ููุฑู
- ุฅุฐุง ูู ููู ูุชุงุญุงูุ ูุนูู ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูู 30 ุซุงููุฉ

### 3. **ุงูุฃุฏุงุก**
- ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูุง ูุคุซุฑ ุนูู ุงูุฃุฏุงุก
- ูุชู ุฅูุบุงุก interval ุนูุฏ ุฅุบูุงู ุงูุตูุญุฉ

---

## โ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุงููุดููุฉ ุจูุฌุงุญ:
- โ ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ focus
- โ ุชุญุฏูุซ ููุฑู ุนุจุฑ WebSocket
- โ ุฒุฑ ุชุญุฏูุซ ูุฏูู
- โ ุฅุตูุงุญ ูุดููุฉ ุงูุญุงูุฉ ุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 2025-01-27
**ุงูุญุงูุฉ**: โ ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู

